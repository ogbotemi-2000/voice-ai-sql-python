<!DOCTYPE HTML><html lang="en"><head>
        <title>Web App for SQL Database Interaction _ Supports RAG with Timescale and PGVector _ Interact with Ollama via widget _ Upload query-response to Pinata _ MySQL UI</title>
        <meta charset="utf-8">
        <meta name="keywords" content="Retrieval Augmented Generation pgvector Timscale Connection Pooling UI Ollama REST API Interaction Local SQL RDBMS Client">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="/static/css/tailwind.min.css">
        <link rel="stylesheet" href="/static/css/all.min.css">
        <link rel="stylesheet" href="/static/css/page.css">
        <link rel="stylesheet" href="/static/css/github.css">
        <link rel="shortcut icon" href="/static/favicon.ico">
        
        <script src="/static/js/sql.js"></script>
        <script src="/static/js/ripples.js"></script>
        <script src="/static/js/utils.js"></script>
        <script src="/static/js/both.js"></script>
        <script src="/static/js/highlight.min.js"></script>
        <script src="/static/js/handleAudio.js"></script>
<script>
let debug=/debug/.test(location.search), slice=arr=>[].slice.call(arr), qsa=str=>slice(document.querySelectorAll(str)),
    uuid   = (a) => (a ? (a ^ ((Math.random() * 16) >> (a / 4))).toString(16) : ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, uuid)),
page = {
  metadata:'', embedding:'',
  misc : {user:1, host:1, port:1, database:1},/*perpetual truthies to aid reassignment to values provided in database URL*/
  isLocal: /localhost/.test(window.location.hostname),
  setup: function(node, str) {
    let ind=0, parts = both.dBParts(str), misc= {1:'user', 3:'host', 4:'port', 5:'database'};
    page.asText(node, (n, r, nx)=>{
      nx = n.nextSibling,
      r=n.hasAttribute&&n.hasAttribute('contenteditable')||n.value!=void 0,
      r&&nx&&nx.data&&(page.misc[misc[ind]]&&=parts[ind], n.value=n.textContent=parts[ind++])
    })
  },
  i: 0,
  templates: [`<span class="font-semibold text-pink-500 inline-block mb-1">SELECT</span>
  table_cell_id, 
  <span class="inline-block my-1 font-semibold text-pink-500">first_field</span>
<span class="font-semibold text-pink-500 inline-block my-1">FROM</span>
  table_name
<span class="font-semibold text-pink-500 inline-block my-1">WHERE</span>
  table_cell_id = <span class="font-semibold text-blue-400 inline-block">1</span>;`,
`<span class="font-semibold text-pink-500 inline-block mb-1">UPDATE</span> table_name
<span class="inline-block my-1 font-semibold text-pink-500">SET</span> first_field  = second_field
<span class="font-semibold text-pink-500 inline-block my-1">WHERE</span> table_cell_id = 3
<span class="font-semibold text-pink-500 inline-block my-1">RETURNING</span> *;`,
`<span class="font-semibold text-pink-500 mb-2 inline-block">INSERT INTO</span> table_name (<span class="font-semibold text-pink-500 mb-2 inline-block">first_field, second_field</span>)
<span class="font-semibold text-pink-500">VALUES</span>
  (<span class="text-green-500 mb-2 inline-block">'Value one', '08-06-2024'</span>),
  (<span class="text-green-500 mb-2 inline-block">'Value three', '12-01-2023'</span>),
  (<span class="text-green-500 mb-2 inline-block">'Value five', '10-12-2020'</span>)
<span class="font-semibold text-pink-500 mb-2 inline-block">RETURNING</span> *;`,
`<span class="font-semibold text-pink-500 mb-2 inline-block">ALTER TABLE</span> table_name
<span class="font-semibold text-pink-500">ADD COLUMN</span> table_cell_id <label class="input-sizer inline-grid font-semibold"><input type="text" spellcheck="false" oninput="this.parentNode.dataset.value = this.value" size="7" value="SERIAL" placeholder="TYPE" list="types" class="outline-none border-b border-current text-yellow-500"></label> <span class="font-semibold text-pink-500">PRIMARY KEY</span>;`,

`<span class="font-semibold text-pink-500">CREATE TABLE</span> table_name (<br>
  table_cell_id <label class="input-sizer inline-grid font-semibold"><input type="text" spellcheck="false" oninput="this.parentNode.dataset.value = this.value" size="7" value="SERIAL" placeholder="TYPE" list="types" class="outline-none border-b border-current text-yellow-500 p-1"></label> PRIMARY <span class="font-semibold text-pink-500">KEY</span>,
  first_field  <label class="input-sizer inline-grid font-semibold"><input type="text" spellcheck="false" oninput="this.parentNode.dataset.value = this.value" size="14" value="VARCHAR(255)" placeholder="TYPE" list="types" class="outline-none border-b border-current text-yellow-500 p-1"></label><span class="font-semibold text-pink-500"> NOT </span><span class="font-semibold text-blue-400">NULL</span>,
  second_field <label class="input-sizer inline-grid font-semibold"><input type="text" spellcheck="false" oninput="this.parentNode.dataset.value = this.value" size="5" value="DATE" placeholder="TYPE" list="types" class="outline-none border-b border-current text-yellow-500 p-1"></label><span class="font-semibold text-pink-500"> NOT </span><span class="font-semibold text-blue-400">NULL</span>
);`,
`<span class="font-semibold text-pink-500 mb-2 inline-block">ALTER TABLE</span> table_name
<span class="font-semibold text-pink-500">DROP CONSTRAINT</span> table_cell_id;`],
asText: function(node, fn, txt='', _txt, cb, val) {
    (cb=(nodes, flag, bool)=>slice(nodes).forEach((ch, res)=>{
      res = ch.data || ch.value || '',
      txt += bool = fn&&fn.call ? fn(ch) : res,
      !bool&&ch.childNodes.length&&cb(ch.childNodes, !0)
    }))(node.childNodes),
    _txt = node.innerText,
    val = _txt.length>txt.length ? txt : txt;
    return txt;
  }
};
</script>

<style>
#queries * {
  background-color: transparent;
}
html {
  --bg-opacity-pad: 0;
}
.out-in-out {
  --dur: 0s;
  --x: -101%;
  animation: out-in-out var(--dur) ease-in-out forwards;
}
@keyframes out-in-out {
  from {
    transform: translate3d(var(--x), 0px, 0px)
  }
  to {
    transform: translate3d(calc(var(--x) * -1), 0px, 0px)
  }
}

.bg-near-black {
  background: #282828;
}
.affix {
  --gap: 0em;
  position: fixed;
  top: var(--gap);
}
.input-sizer::after {
  content: attr(data-value) "  ";
  visibility: hidden;
  white-space: pre-wrap;
}

.dots-1 {
  --_g: no-repeat radial-gradient(circle closest-side,#000 90%,#0000);
  background: 
    var(--_g) 0    0,
    var(--_g) 0    100%,
    var(--_g) 100% 100%;
  background-size: 40% 40%;
  animation:d1 1s infinite linear;
}
@keyframes d1 {
    25% {background-position:100% 0   ,0 100%,100% 100%}
    50% {background-position:100% 0   ,0 0   ,100% 100%}
    75% {background-position:100% 0   ,0 0   ,0    100%}
    100%{background-position:100% 100%,0 0   ,0    100%}
}
    html {
    scroll-behavior: smooth;
}
@keyframes anim-round { 0%,100% { transform: translate3d(var(--_reach), 0px, 0px); } 25% { transform: translate3d(0px, var(--_reach), 0px); } 50% { transform: translate3d(var(--reach), 0px, 0px); } 75% { transform: translate3d(0px, var(--reach), 0px); } }
.bg-squiggle {
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' width='6' height='3' fill='%23facc15'%3e%3cpolygon points='5.5%2c0 2.5%2c3 1.1%2c3 4.1%2c0'/%3e%3cpolygon points='4%2c0 6%2c2 6%2c0.6 5.4%2c0'/%3e%3cpolygon points='0%2c2 1%2c3 2.4%2c3 0%2c0.6'/%3e%3c/svg%3e");
}
.draw-stroke {
  stroke-dasharray: 1;
  stroke-dashoffset: 1;
  animation: draw-stroke 1s ease-out infinite alternate;
}
@keyframes draw-stroke {
    0% {
    stroke-dashoffset: 1;
}

100% {
    stroke-dashoffset: 0;
}
    }
@font-face {
    font-family: 'Capsmall_clean';
    font-style: normal;
    font-weight: normal;
    src: local("/static/fonts/Capsmall_clean"), url("/static/fonts/Capsmall_clean.woff") format('woff');
		}
    .font-capture {
      font-family: Capsmall_clean;
    }
    *:hover > .decorate > div, chrome .decorate-parent:hover > .decorate > div {
                --tw-scale-x: 8;
                --tw-scale-y: 8;
                transform: scale3d(var(--tw-scale-x),var(--tw-scale-y),1);
                --tw-bg-opacity: 0.15;
              }

            * > .decorate.out > div, .decorate-parent > .decorate.out > div {
                --tw-scale-x: 8;
                --tw-scale-y: 8;
            }

            *:hover > .decorate.out > div, .decorate-parent:hover > .decorate.out > div {
                --tw-scale-x: 1;
                --tw-scale-y: 1
            }
        </style>
    </head>
    <body>
      <div class="w-full py-2 overflow-hidden fixed mt-2 tooltip no-hover no-focus no-focus-withiin slide-y" id="visualCue">
    <div class="absolute transform-gpu -left-1/4 right-2/3" style="--dur: 5s; animation-timing-function: linear; animation-iteration-count: infinite;" data-stop="" onanimationiteration="let btns=qsa('.voicesql section.md\\:show button'), dur=this.style.getPropertyValue('--dur'); dur!=='0s'&&(btns[2].click(), setTimeout(_=>btns[0].click(), 50))">
<span class="-right-1/4 -mt-1.5 top-0 absolute p-2  bg-yellow-800 rounded-full inline-block"></span></div>
<hr class="border border-current rounded-full p-0.5 w-full">
</div>

<aside id="configure" style="--tw-bg-opacity:calc(var(--bg-opacity-pad) + 0.15); z-index: 5;" class="tooltip no-hover no-focus no-focus-within -slide-y bg-gray-100 flex items-center justify-center text-center inset-0 backdrop-blur-sm backdrop-filter fixed">
        <section class="relative p-6 rounded-lg shadow bg-white inline-block text-sm font-bold text-sm text-left mx-6 text-gray-800">Database Connection String
          <!-- do not add nodes before the element below here except textNodes in order to ensure proper behaviour -->
          <main class="[&>*]:inline-block" oninput="let type=event.inputType, tx=str=Abbr.to(event.target, ['tC', 'value'], !0); type==='insertFromPaste'&&page.setup(this, tx)">
              <label class="relative"><div class="font-normal text-xs w-full text-center">SQL RDBMS</div><input class="outline-none font-semibold border-b border-current" list="rdbms" size="8" spellcheck="false">://<datalist id="rdbms"><option value="mysql"></option><option value="postgresql"></option></datalist></label><label class="relative"><div class="left-0 font-normal text-xs text-center">User</div><div class="mx-1 inline-block text-left outline-none font-semibold border-b border-current" spellcheck="false" contenteditable="true" data-placeholder="user, i.e root"></div>:</label><label class="relative"><div class="font-normal text-xs text-center">Database password</div><input class="mx-1 outline-none font-semibold border-b border-current text-center" list="rdbms" spellcheck="false" type="password" size="12">@</label><label class="mt-2 relative"><div class="left-0 font-normal text-xs text-center">Host</div><div class="mx-1 outline-none font-semibold border-b border-current inline-block" spellcheck="false" contenteditable="true" data-placeholder="hostname"></div>:</label><label class="relative"><div class="font-normal text-xs text-center">Port</div><input class="outline-none font-semibold border-b border-current mx-1" size="3" spellcheck="false">/</label><label class="mr-2 mt-2 relative"><div class="left-0 font-normal text-xs text-center">Database</div><div class="outline-none font-semibold border-b border-current inline-block mx-1" spellcheck="false" contenteditable="true" data-placeholder="name"></div>?</label><label class="mt-2 relative"><div class="left-0 font-normal text-center text-xs">key, value pairs</div><div class="outline-none font-semibold border-b border-current mx-1" spellcheck="false" contenteditable="true" data-placeholder="key1=value1&key2=value2"></div>
              </label><!--leave a whitespace here for proper behaviour of custom database URL--> </main>
  
              <p class=" mt-2 font-normal"><i class="fa fa-exclamation p-1 rounded-full border px-2 mr-1 border-gray-500"></i><i>You can always close and re-open this dialog to configure the service with your database URL by pasting it in any input field above to autofill the rest.</i></p>
          <div class="mt-3 text-right w-full">
            <button class="mt-3 -mr-6 p-3 rounded-l-full bg-green-200 px-5 ripple relative" onclick="let flag, text=page.asText(Abbr.to(this, [{2:'pN'}, 'fEC']), (n, r, nx)=>{
              nx = n.nextSibling,
              r=n.hasAttribute&&n.hasAttribute('contenteditable')&&n.textContent||n.value;
              r&&=nx&&nx.data&&r+nx.data;
              return r||''
          }).trim().replace(/\?$/, ''); flag=account.setup.value!=text, text&&(account.query.value='', account.setup.value=text, flag?(bugs.classList.remove('show'), submit()):Abbr.to(this,'fEC').style.setProperty('--dur', '0s'), this.disabled=true, Abbr.to(this, ['fEC', 'cL']).add('out-in-out'))">
                <div onanimationend="Abbr.to(this, 'pN').disabled=false, Abbr.to(this, [{4:'pN'}, 'cL']).remove('show'), Abbr.to(this, 'cL').remove('out-in-out')" class="absolute inset-0 bg-yellow-500 transform-gpu -translate-x-full" style="--dur:20s;"></div>
                <span class="relative">configure app</span>
              </button></div>
              <button onclick="Abbr.to(this, [{2:'pN'}, 'cL']).remove('show')" class="ripple border-t border-r border-gray-700 bottom-0 left-0 absolute p-4 px-6 rounded-tr-lg rounded-bl-lg">close</button>
              </section>
            </aside>
<aside class="voicesql bg-gradient-to-tr from-transparent via-blue-200 no-hover no-focus no-focus-within rounded-b-xl w-full top-0 fixed tooltip -slide-y" style="z-index:4;">
    <canvas class="absolute inset-0 pointer-events-none"></canvas>
<svg xmlns="http://www.w3.org/2000/svg" class="absolute inset-0 rounded-inherit pointer-events-none backdrop-filter backdrop-blur-sm" width="100%" height="100%">
          <filter id="noise" x="0" y="0">
          <feTurbulence type="fractalNoise" baseFrequency="0.65" numOctaves="3" stitchTiles="stitch"></feTurbulence>
          <feBlend mode="screen"></feBlend>
          </filter>
          <rect width="100%" height="100%" filter="url(#noise)" class="absolute opacity-70 sm:opacity-80"></rect>
      </svg><main class="pt-4 w-full px-4 rounded-inherit [&>*]:p-2 justify-around">
    <h3 class="relative font-semibold show">Generate SQL from audio recordings</h3>
<main style="min-height:280px;" class="items-start flex w-full">
        <section class="lg:show lg:relative pl-2 flex-1 tooltip no-hover no-focus no-focus-within text-sm [&>*]:inline-block [&>*]:align-middle show" style="z-index:4"><aside class="right-full w-3 top-2 h-full absolute border-current border border-r-0 rounded-l-lg"></aside>

<p class="ripple relative p-1 w-full block text-left font-semibold text-gray-700 mb-1 text-base"><i class="mr-2 fa fa-cog"></i>Configure streaming audio</p>
    <code class="font-semibold">Stream audio every: </code><input class="rounded-tr-lg text-center border-r w-20 border-t border-current bg-transparent py-2" oninput="qsa('[data-stop]').forEach(e=>e.style.setProperty('--dur', (Aud.streaming = this.value)+'s'))" type="number"> seconds<hr class="mx-3 p-1 rounded-full bg-black">
<div class="inline-block">
<code class="font-semibold">Bitrate: </code><input class="border-r rounded-br-lg  w-20 border-b border-current bg-transparent p-2 text-right" value="128" type="number" oninput="Aud.bitRate=+this.value"> Kbits/ second
<button class="relative p-2"><i class="text-lg fa fa-exclamation-circle"></i>
<div class="sm:w-48 border border-gray-400 text-sm text-left bg-gray-100 absolute tooltip to-bottom w-24 p-3" style="--arrow-size:5px; transform:none; --arrow-x:-500%;">The bitrate is adaptive by default.<hr class="border-gray-400 my-2">Alter this only if you understand what you are doing because it may affect the quality of audio and TTS</div></button></div><br><p class="w-full mt-4 font-semibold">Visual cue for delay between streams</p><div class="w-full py-2 overflow-hidden relative">
    <div class="absolute transform-gpu -left-1/4 right-2/3" style="--dur: 5s; animation-timing-function: linear; animation-iteration-count: infinite;" data-stop="" onanimationends="let btns=qsa('.voicesql section.md\\:show button'); this.style.getPropertyValue('--dur')!=='0s'&&(console.log('::ANIMATED::', event), btns[2].click(), setTimeout(_=>btns[0].click())">
<span class="-right-1/4 -mt-1.5 top-0 absolute p-2  bg-yellow-800 rounded-full inline-block"></span></div>
<hr class="border border-current rounded-full p-0.5 w-full">
</div><i class="inline-block mr-2 fa fa-exclamation"></i> For best results, specify a fair amount of time like <code class="font-semibold text-lg">≥10s</code> and only utter words before the slider reaches its end to avoid breaking them apart
</section><section class="w-full sm:mx-5 flex-1 sm:relative sm:show tooltip no-hover no-focus no-focus-within text-sm absolute">
    <div class="mb-1 inline-block relative">
<button class="text-gray-700 font-semibold text-sm ripple relative rounded border border-current p-3 px-5 mr-2">Add</button>
<form class="mt-1 animated text-center absolute tooltip bg-purple-50 rounded-xl p-3 pb-0" onsubmit="event.preventDefault(); let ctx=intelligence, el = crE('div', [], {className:'flex-1', innerHTML:`<code class='text-2xl font-semibold'>${this.glyph.value.trim()}</code><br><pre>${this.term.value.trim()}</pre>`}), bool; ctx.textContent.replace(el.textContent, m=>bool=!!m), bool?Abbr.to(this,'cL').add('shake'):(ctx.appendChild(el), ['glyph','term'].forEach(prop=>this[prop].value='')); return 0;" style="pointer-events:auto;" onanimationend="Abbr.to(this,'cL').remove('shake')">
<input class="font-mono bg-transparent text-xl p-2 border-b border-gray-600 text-center" size="5" placeholder="glyph" required="" name="glyph">
<br>
<input class="font-mono bg-transparent p-2 border-b border-gray-600 text-center" placeholder="word, sentence, morpheme" name="term" size="26" required="">
<br>
<button class="border-gray-500 border-l border-r ripple relative p-3 float-left py-5">
    Add combination
</button></form></div><h4 class="inline-block font-semibold text-base text-gray-700 mr-3"><i class="fa fa-bulb"></i>Intelligence</h4><br>
<p class="inline">Replace words or sentences spoken by you with glyphs that have similar meaning to them in either SQL or other scopes. You can "Add" to or edit the template below as text.</p><kbd class="ml-3 inline-block mb-3 text-xs p-2 rounded-full bg-gray-100">editable</kbd><section class="w-full items-end text-xs [&>*]:p-2 text-center flex flex-wrap divide-x-2 divide-gray-500 overflow-scroll" contenteditable="" style="max-height:110px" id="intelligence"><div class="flex-1"><code class="text-2xl font-semibold"><</code><br><pre>less than</pre></div>
<div class="flex-1"><code class="text-2xl font-semibold">=</code><br><pre>equal to</pre></div>
<div class="flex-1"><code class="text-2xl font-semibold">></code><br><pre>greater than</pre></div>
<div class="flex-1"><code class="text-2xl font-semibold">.</code><br><pre>period</pre></div>
<div class="flex-1"><code class="text-2xl font-semibold">_</code><br><pre>underscore</pre></div>
<div class="flex-1"><code class="text-2xl font-semibold">"</code><br><pre>double quote</pre></div>
<div class="flex-1"><code class="text-2xl font-semibold">*</code><br><pre>asterisk</pre></div>
<div class="flex-1"><code class="text-2xl font-semibold">,</code><br><pre>comma</pre></div>
</section>
</section>

<section class="flex-1 md:relative md:show tooltip no-hover no-focus no-focus-within absolute">
    <h4 class="text-gray-700 text-left font-semibold">Control your recordings</h4>
<section class="mt-2 text-center [&>*]:inline-block [&>*]:align-middle flex-1" onclick="let t=event.target, index = slice(this.children).indexOf(Abbr.to(t,'pN')); if(t.tagName!=='BUTTON') return; Aud(qsa('.voicesql audio')[0]).then(_=>{ this.querySelectorAll('button').forEach((e,i)=>e.disabled=index==2?i:!i), !index&&(Abbr.to(window.recording,'cL').add('show'), !0)&&+qsa('.voicesql input')[0].value&&(qsa('[data-stop]').forEach(e=>Abbr.to(e,'cL').add('out-in-out')), Abbr.to(visualCue,'cL').add('show')), Aud.fxns[index](), [this.querySelector('button.text-white')||t, t].forEach((el, i)=>Abbr.to(el,'cL')[/* from utils.js*/cLs(i)]('text-white', 'bg-black')) }).catch((giveUp, msg)=>{ Abbr.to(voiceError,'cL').replace('absolute','show'), Abbr.to(voiceError,'fEC').textContent=msg, Aud.inited=giveUp/*falsy argument implies caught errors which require retries*/})">
<div class="mr-4"><button class="duration-300 ease-out ripple relative px-8 p-7 border-current rounded-full border text-3xl fa fa-microphone"></button><i style="font-style:normal" class="text-base block">start</i></div>
  <div class="mr-4"><button class="duration-300 ease-out ripple relative p-7 border-current rounded-full border text-3xl fa fa-microphone-slash" onclick="let ctx=Abbr.to(this,'nES'), bool; ctx.textContent=(bool=ctx.textContent==='pause')?'resume':'pause', qsa('[data-stop]').forEach(e=>Abbr.to(e,'cL')[cLs(!bool)]('out-in-out'))" disabled=""></button><i style="font-style:normal" class="text-base block">pause</i></div><div class="mr-4">
  <button class="duration-300 ease-out ripple relative px-8 p-7 border-current rounded-full border text-3xl fa fa-stop" onclick="Abbr.to(recording,'cL').remove('show'), setTimeout(_=>{ Abbr.to(this,'cL').remove('bg-black', 'text-white') }, 300), Abbr.to(this,{2:'pN'}).querySelectorAll('button').forEach((e,i)=>e.disabled=i), qsa('[data-stop]').forEach(e=>Abbr.to(e,'cL').remove('out-in-out')), Abbr.to(visualCue,'cL').remove('show')" disabled=""></button><i style="font-style:normal" class="text-base block">stop</i></div></section>
<aside style="pointer-events: auto;" class="rounded-xl items-center inline-flex mt-2 pl-3 bg-red-100 text-xs tooltip slide-y no-hover no-focus no-focus-within absolute" id="voiceError">
    <code>An error occured when receiving response from TTS</code><button class="rounded-r-xl ml-4 bg-red-200 px-8 border-current p-6 border-l fa fa-times ripple relative" onclick="['show','absolute'].forEach(cls=>Abbr.to(this,['pN','cL']).toggle(cls))"></button>
</aside></section>

    </main>
</main><aside class="justify-around my-3 relative text-center flex">
    <audio controls="" ></audio><button class="md:hidden ripple relative border border-l-0 border-current rounded-r-lg p-3" onclick="let ctx=Abbr.to(this,['pN','pES','lEC']), ch=ctx.children, cls='show', i=0; [[].find.call(ch, (e, _i, b)=>(b=Abbr.to(e,'cL').contains(cls))&&(i=_i, b)), ch[++i%ch.length]].forEach(e=>[cls, 'absolute'].forEach(cl=>Abbr.to(e,'cL').toggle(cl)))">
    
<i class="align-middle inline-block mr-2 fa fa-arrow-right"></i> <span class="tooltip no-hover ml-3 sm:mx-6 no-focus base:show base:relative absolute">continue to next</span>
</button>
<button class="md:p-5 md:px-6 relative ripple border border-current bottom-0 right-2 md:absolute p-3 px-6 rounded-full fa fa-times" onclick="Abbr.to(this,[{2:'pN'},'cL']).remove('show')"></button>
</aside>

</aside>

      <nav class="pt-7 text-right [&>*]:text-left top-0 fixed right-0 z-3">
        
          <article class="z-3 inline-block duration-300 ease-out relative">
<main class="text-sm sm:w-96  border-2 rounded-xl pt-7 p-4 text-left bg-white w-80 absolute right-0 top-0 tooltip" style="z-index:auto;">
    
<ul class="[&>*]:p-2 relative list-disc ml-4" style="max-height: 50vh;overflow:scroll"><h3 class="font-semibold">Assembly AI Speech-to-Text</h3>

<li>After providing an interval for streaming audio, a page-wide slider is automatically added to the top of the page for a quick visual aid when you close the pane.</li>
<h3 class="font-semibold">Global values</h3><li><kbd class="mr-1 inline-block bg-gray-50 p-1 border rounded-lg border-gray-400">page.result, page.embedding, page.metadata</kbd> are available in the console for modifying or viewing the query with result and metadata with embeddings respectively</li><h3 class="font-semibold" style="margin:0">Editor</h3><li>A semi-colon is automatically added to the query if absent before it is executed on the database</li>
<li><kbd class="float-left mr-2 inline-block bg-gray-50 p-1 border rounded-lg border-gray-400">Ctrl + ←<span class="align-middle inline-block">↑<br>↓</span>→</kbd> quickens the cursor movements by making it jump over words.</li><li><kbd class="mr-1 p-1 bg-gray-50 border rounded-lg border-gray-400 inline-block">Shift + </kbd><i> the key combination above</i> highlights words at once.</li>

<li>Run the query below to get all available extensions
<pre class="whitespace-pre-wrap"><code class="language-sql mr-1 inline-block bg-gray-50 p-2 text-xs border rounded-lg border-gray-400 hljs" data-highlighted="yes"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> pg_available_extensions <span class="hljs-keyword">WHERE</span> name <span class="hljs-operator">=</span> <span class="hljs-string">'vector'</span>;</code></pre></li></ul>
</main><button class="border-gray-300 border-2 rounded-b-xl p-2 bg-gray-200 ripple relative inline-block"><i class="px-3 text-xs border border-current rounded-full inline-block p-2 fa fa-exclamation"></i> Hints</button></article><a class="rounded bg-white-300 p-2 align-middle inline-block" href="https://github.com/ogbotemi-2000/sqlUI_pinata" target="_blank"><i class="fab fa-github text-3xl"></i></a><br>

<button class="m-2 align-middle ripple relative md:hidden ripple relative p-3 bg-yellow-100 rounded-full text-3xl px-3.5" onclick="[Abbr.to(this, 'nES'), Abbr.to(this, {2:'nES'})].forEach(el=>['relative', 'show', 'absolute'].forEach(cls=>Abbr.to(el,'cL').toggle(cls)))"><i class="fa fa-th"></i></button><article class="slide-y md:relative md:show no-hover no-focus-within no-focus tooltip align-middle inline-block duration-300 ease-out text-xs sm:text-sm mb-4 mx-4 sm:mt-4 absolute" style="z-index:2">
<main class="sm:w-96 border-2 rounded-xl pt-7 p-4 text-left bg-white w-80 absolute top-0 tooltip pb-0 right-0" style="z-index:auto; pointer-events:auto">
    <h3 class="font-semibold mb-2">Interact with Ollama models</h3>
<ul class="relative pl-4">
<li class="[&>*]:inline-block [&>*]:align-top"><p>Connection</p><br>Host:<div class="w-5/6 ml-2 outline-none p-2 bg-transparent border-b border-current inline-block align-bottom" value="http://127.0.0.1:11434" style="vertical-align:bottom" contenteditable="true" data-placeholder="URL to Ollama API">http://127.0.0.1:11434/</div>
<br><span class="mt-2 mr-3">Request body <button class="ripple relative ml-2 bg-gray-100 text-xs p-2 rounded-xl inline-block border border-gray-300" onclick="let ctx=Abbr.to(this, ['pN',{2:'nES'},'fEC']); ctx.innerHTML = hljs.highlightAuto(ctx.textContent).value">format<i class="fa fa-highlighter ml-2"></i></button></span><kbd style="vertical-align:bottom">{</kbd><pre class="border-gray-300 border-b w-full whitespace-pre-wrap overflow-scroll" style="max-height: 120px;"><code class="inline-block language-json hljs p-2 text-xs pr-4 w-full whitespace-pre-wrap" contenteditable="" spellcheck="false" data-highlighted="yes"><span class="hljs-attr">"model"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"llama2"</span><span class="hljs-punctuation">,</span>
<span class="hljs-attr">"prompt"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"<can be="" either="" plain-text="" or="" formatted="">"</can></span>
</code></pre><pre class="text-xs m-2 w-full whitespace-pre-wrap"><code class="hljs language-json" data-highlighted="yes"><span class="hljs-attr">"streaming"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"false"</span></code></pre>
}<br><button class="ml-1 mb-1 mt-1.5 ripple relative p-3 rounded bg-near-black text-white" onclick="let qs=str=>Abbr.to(this,'pN').querySelector(str), 
url=qs('[contenteditable]').textContent, req=page.asText(qs('code')), aside = Abbr.to(this, ['pN', 'nES']), flag=/embedding/.test(url), data, result, embed='', meta,
out=arg=>{
  /**hasten the visual feedback*/visual.style.setProperty('--dur', '3s'),
  setTimeout(_=>{
    aside.querySelector('pre').innerHTML = both.format(JSON.stringify(flag===0?/*error*/{error:result.message}:result)),
    ['translate-y-1/4', 'pointer-events-none', 'opacity-0'].forEach(cls=>Abbr.to(aside, 'cL').toggle(cls))
  }, 500)
}, visual=Abbr.to(this, 'fEC');
Abbr.to(visual,'cL').add('out-in-out');/*the added class is removed onanimationend */
try {
  fetch(url, {
    method: 'POST',
    body: (data = JSON.parse(`{${req}}`), data.streaming = false, meta=JSON.stringify(data))
  }).then(res=>res.json()).then(res=>{
      result = res, flag&&(/*store embedding to be sent to the server later*/account.embedding.value = embed = res.embedding)
  }).catch(err=>{result=err, flag=0})
  .finally(_=>{
    window.metadata.textContent = both.format((page.metadata = meta).slice(0, 100)+('...'.repeat(meta.length>100))),
    window.embedding.textContent = (page.embedding = embed).slice(0, 100)+('...'.repeat(embed.length>100)),
    out()
  })
} catch(err) {
  /*doing the same things done in catch clause above to make out behave similarly*/
  flag = 0, result = err, console.log(err, [err.message, err.reason], JSON.stringify(err)),
  out()
} 
">
  <div onanimationend="Abbr.to(this, 'cL').remove('out-in-out'), this.style.setProperty('--dur', '5s')" class="absolute inset-0 bg-yellow-600 transform-gpu -translate-x-full" style="--dur: 5s;"></div>
  <span class="relative">pet the Llama</span>
</button></li><aside class="duration-300 ease-out bg-white absolute inset-0 transform translate-y-1/4 pointer-events-none opacity-0">
  <button type="button" onclick="['translate-y-1/4', 'pointer-events-none', 'opacity-0'].forEach(cls=>Abbr.to(this, ['pN', 'cL']).toggle(cls))" class="right-0 ripple px-4 p-3 fa fa-times text-lg absolute border border-gray-600 rounded-full mt-4"></button>
  <pre class="text-xs w-full h-full overflow-scroll pr-11 py-4 word-break p-2 whitespace-pre-wrap">{
	"error":"Failed to fetch"
}</pre>
</aside>
</ul><div class="text-right"><button class="ripple relative bg-gray-200 rounded-full p-2 px-4" onclick="let bool, ch=this.childNodes; ch[0].data = 'un'.repeat(bool=ch[1].classList.toggle('fa-lock-open')) + 'pin widget', Abbr.to(this, [{2:'pN'}, 'cL'])[bool?'add':'remove']('show')">pin widget<i class="ml-2 text-lg fa fa-lock"></i></button></div>

<p class="rounded-b-lg mt-2 bg-gray-100 text-xs px-5 -mx-4 p-2.5">Ensure to run <code>ollama pull [model]</code> and <code>ollama use [model]</code> before using this widget</p>
</main><button class="sm:m-2 p-2 rounded-full bg-white ripple relative inline-block" id="openOllama"><img class="m-auto w-8" src="/static/ollama.png"></button></article><article class="align-middle slide-y md:relative md:show no-hover no-focus-within no-focus tooltip md:inline-block duration-300 ease-out text-xs absolute" style="z-index:1">
<main class="sm:w-96 border-2 rounded-xl p-4 text-left bg-white w-80 absolute top-0 tooltip right-0" style="z-index:auto; pointer-events:auto;">
    <h3 class="w-1/2 font-semibold mb-1">Retrieval Augmented Generation</h3><p class="mt-3 text-center -mx-5 text-sm p-3 bg-blue-100 text-xs">Requires a PostgreSQL database provider that support vector embeddings such as <a class="text-sm p-1 underline inline-block" target="_blank" href="https://console.cloud.timescale.com/">Timescale ↗</a>, <a class="text-sm p-1 underline inline-block" target="_blank" href="https://neon.tech/">Neon ↗</a></p>
<section class="flex [&>*]:p-2 mb-2 -mx-4 [&>*]:relative" onclick="if(event.target==this) return; let cls='bg-blue-200', t=event.target, i=[].slice.call(this.children).indexOf(t), cNs=[].slice.call(Abbr.to(this, ['nES', 'children'])); [this.querySelector('.'+cls), event.target].forEach(n=>n.classList.toggle(cls)), cNs[i]&&[Abbr.to(this, 'nES').querySelector('.opacity-100')||cNs[i], cNs[i]].forEach((e,_i)=>e.classList[_i?'add':'remove']('opacity-100', 'pointer-events-auto'))"><button class="ripple w-1/3 hover:bg-blue-100 bg-blue-200">Schema</button><button class="ripple w-1/3 hover:bg-blue-100">Embedding</button><button class="ripple w-1/3 hover:bg-blue-100">Database</button></section>

<ul class="my-2 relative list-disc pl-4">
<li class="pointer-events-none opacity-0 duration-300 ease-out opacity-100 pointer-events-auto"><h4 class="font-semibold text-gray-700">Create Schema</h4>
<i class="my-1 block">Edit templates</i>
<button class="text-left font-mono ripple relative inline-block border border-gray-300 rounded-xl p-3 text-xs" onclick="queries.removeAttribute('data-highlighted'), queries.innerHTML = hljs.highlightAuto(this.textContent).value, sendQuery.disabled=0">
<pre class="whitespace-normal"><code class="language-sql hljs" data-highlighted="yes"><span class="hljs-keyword">CREATE</span> EXTENSION IF <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> ai CASCADE;</code></pre>
</button><button class="text-left font-mono ripple relative mt-1 inline-block border border-gray-300 rounded-xl p-3 text-xs" onclick="queries.removeAttribute('data-highlighted'), queries.innerHTML = hljs.highlightAuto(this.textContent).value, sendQuery.disabled=0"><pre class="whitespace-normal"><code class="language-sql hljs" data-highlighted="yes">
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> data (id SERIAL <span class="hljs-keyword">PRIMARY</span> KEY, metadata text, embedding vector);
</code></pre></button></li>
<li class="right-0 left-4 top-0 absolute opacity-0 duration-300 ease-out pointer-events-none"><h4 class="mb-2 font-semibold text-gray-700">Embedding from Ollama</h4>
The requested embedding is automatically stored and used in this application if successful.<i class="mt-3.5 block">Click on the button below to open the Ollama widget</i><button class="mt-2 text-left font-mono ripple relative mt-1 inline-block border border-gray-300 rounded-2xl p-3" onclick="let el=Abbr.to(openOllama, 'pN').querySelector('[contenteditable]'), url=el.textContent;
el.textContent = url.replace(/(\/api[^]+|\/*)$/, '/api/embeddings'), openOllama.focus()">
<img class="mr-3 inline-block w-7" src="/static/ollama.png"> api/embeddings</button>
</li><li class="right-0 left-4 top-0 absolute opacity-0 duration-300 ease-out pointer-events-none"><h4 class="font-semibold text-gray-700">Add seed data to database</h4>
<i class="mb-2 my-1 block">Click on each to expand/edit in editor</i>
<button class="justify-between items-center w-full flex font-mono ripple relative hover:bg-gray-100 border border-gray-300 rounded-xl p-1 text-xs" onclick="queries.innerHTML = hljs.highlightAuto('SELECT metadata, embedding <-> $1 AS distance FROM data ORDER BY distance LIMIT 3').value, sendQuery.disabled=0" style="overflow: visible;">
<code class="mr-2 font-semibold rounded-inherit border border-gray-300 inline-block text-pink-500 p-3">SELECT</code>... <-> $1 ... 
<code class="ml-2 font-semibold rounded-inherit border border-gray-300 inline-block p-3 relative">[embedding]<aside class="font-normal border-gray-300 border-2 text-left p-3 bg-white tooltip to-left absolute " style="--arrow-size: 6px;"><strong>Embedding</strong><pre id="embedding" class="whitespace-pre-wrap" style="max-height: 200px; max-width: 200px;"></pre>

</aside></code></button><button class="mt-2 justify-between items-center w-full flex font-mono ripple relative hover:bg-gray-100 border border-gray-300 rounded-xl p-1 text-xs" onclick="queries.innerHTML = hljs.highlightAuto('INSERT INTO data (metadata, embedding) VALUES ($1, $2)').value, sendQuery.disabled=0" style="overflow: visible;">
<code class="mr-2 font-semibold rounded-inherit border border-gray-300 inline-block text-pink-500 p-3">INSERT</code>..($1, $2) 
<code class="relative flex-1 ml-2 font-semibold rounded-inherit border border-gray-300 inline-block p-3">[metadata, embedding]<aside class="border-gray-300 border-2 font-normal text-left p-3 bg-white tooltip to-left absolute " style="--arrow-size: 6px;"><strong>Metadata</strong><pre class="whitespace-pre-wrap word-break" id="metadata" style="max-height: 200px; max-width: 200px;">{
	"model":"llama2",
	"prompt":"",
	"streaming":false
}</pre>
</aside></code></button></li></ul>
<button class="ripple relative bg-gray-200 rounded-full p-2 float-right px-4" onclick="let bool, ch=this.childNodes; ch[0].data = 'un'.repeat(bool=ch[1].classList.toggle('fa-lock-open')) + 'pin widget', Abbr.to(this, ['pN', 'cL'])[bool?'add':'remove']('show')">pin widget<i class="ml-2 text-lg fa fa-lock"></i></button>

</main><button class="m-2 bg-near-black rounded-full p-1 bg-white ripple relative inline-block [&>*]:inline-block text-white"><img src="/static/timescale.svg">
<span class="mr-2 ml-0.5 font-fredoka">• RAG</span></button></article><!-- <figure class="align-middle sm:inline-block relative">
            <a href="https://www.buymeacoffee.com/oogbotemiT" target="_blank" class="rounded-full hover:bg-gray-300 inline-block px-3 p-1">
            <img src="/static/buymeacoffee.svg" class="w-9 mb-1 m-auto">
            </a>
<figcaption class="top-0 rounded-xl bg-yellow-300 p-3 absolute right-full text-sm tooltip">
    <header class="font-semibold">Buy me a coffee</header><p class="w-52">An online service that enables monetary support from the users of a product to its owner.
<br><i class="inline-block border-t border-current text-gray-800 mt-3">This link opens a new page where you can input the amount you wish to donate in dollars</i></p>
</figcaption>
<aside class="sm:ml-1.5 sm:bottom-1/4 sm:left-2/3 absolute text-2xl -bottom-3 left-1/3 ml-1">↗</aside></figure> -->






</nav>

      <section class="mb-24 sm:mb-32 w-full mt-1 p-10 md:w-4/5 m-auto border-r sm:border-gray-300 border-l relative">
        <i class="fa fa-database text-xl text-gray-600 mr-3"></i><code class="skeleton p-1 rounded-full font-semibold">database</code>
        <p class="my-2 py-3 skeleton italic w-5/6 rounded-full"></p>
        <form enctype="multipart/form-data" id="account" target="response" method="post" action="https://voice-sql-ai.vercel.app/api/accountData" onsubmit="/*event.preventDefault(), */console.log('::SUBMIT::', event), bugs.classList.remove('show')" class="align-middle inline-block mr-56 mb-6">
          <textarea name="query" class="hidden"></textarea>
          <input type="text" name="local" class="hidden">
          <input type="text" name="setup" class="hidden">
          <input type="text" name="embedding" class="hidden">
          <input type="text" name="metadata" class="hidden">
          <!--the input elements above is not rendered but instead used as an ever present part of the request body -->
          <label id="pooled" class="duration-500 top-0 ease-out align-middle toggle-wrapper switch z-1" style="--gap:4em;" role="button">
            <input type="checkbox" name="pooled" oninput="sendQuery.disabled=0/*for when pooling causes errors */">
            <div class="show text-sm p-1.5 tooltip to-right flex align-middle absolute rounded bg-white shadow items-center justify-center text-current p-0.5 text-center" data-details="[inactive]" style="--arrow-size:5px; z-index: auto;">
              <br>
            <hr class="mx-1.5 bulge-center border-0 p-0.5 h-full py-3 border-transparent">
            <p class="whitespace-pre">pooled connection</p>
          </div>
          <span class="slider"></span>
          <br>
          <i class="bg-white absolute right-full dots-1 inline-block top-0 mr-2 p-2" id="loader1"></i>
        </label>
      </form>
      <section class="align-middle inline-block [&>*]:text-center [&>*]:align-middle [&>*]:inline-block mt-2">
        <div>
          <p class="px-4 text-sm mb-2">server address</p>
          <code id="server_addr" class="inline-block"></code>
        </div>
        <hr class="mx-4 p-px h-11 border-0 bg-gray-700">
        <div>
          <p class="px-4 text-sm mb-2">server port</p>
          <code id="server_port" class="px-4 inline-block"></code>
        </div>
      </section>
      
      <h3 class="mt-10 font-semibold text-gray-600">Execute Queries <span class="font-normal">(the templates are editable)</span></h3>
      <div class="my-4 m-2 inline-block [&>*]:p-xy" style="--px:1.2rem; --py:0.6rem;" onclick="let t=event.target, i, ch; if(t.tagName.toLowerCase()!=='button') return; Abbr.to(result, 'cL').remove('show'), (ch=[].slice.call(this.children)).forEach(e=>e.classList[t===e?'add':'remove']('border-2')), ~(i=ch.indexOf(t))&&(page.i!=i)&&(sendQuery.disabled=0, queries.innerHTML = page.templates[i], page.i=i)">
        <button class="ripple relative rounded-l-md border-r-2 border-gray-400 border-2">
          <i class="fa fa-mouse-pointer mr-2"></i>select</button><button class="ripple relative border-l-2 border-r-2 border-gray-400">
          <i class="fa fa-edit mr-2"></i>update</button><button class="ripple relative border-l-2 border-r-2 border-gray-400">
            <i class="fa fa-fill-drip mr-2"></i>insert</button><button class="ripple relative border-l-2 border-r-2 border-gray-400">
              alter<i class="fa fa-pencil-alt ml-2"></i></button><button class="ripple relative border-r-2 border-l-2 border-gray-400">create
          <i class="fa fa-plus ml-2"></i></button><button class="ripple relative rounded-r-md border-l-2 border-gray-400">
          delete<i class="ml-2 fa fa-trash-alt"></i></button>
      </div>

      <main class="mb-0 sm:mx-0 -mx-9 relative shadow border rounded-3xl border-gray-300"><button class="z-1 ripple rounded-full p-4 border border-gray-400 text-2xl fa fa-highlighter m-3 bottom-24 absolute right-0" onclick="queries.innerHTML = hljs.highlightAuto(queries.textContent).value"></button>

<pre class="whitespace-normal"><canvas class="pointer-events-none bottom-2 absolute right-0" id="visualize" height="80"></canvas>
<code id="queries" contenteditable="" oninput="account.setup.value&&(sendQuery.disabled=0)" spellcheck="false" class="overflow-scroll whitespace-pre-wrap duration-700 ease-out rounded-t-3xl p-8 border-b-2 border-gray-300 w-full inline-block language-sql hljs" data-highlighted="yes" style="height: 50vh;"><span class="font-semibold text-pink-500 inline-block mb-1">SELECT</span>
  table_cell_id, 
  <span class="inline-block my-1 font-semibold text-pink-500">first_field</span>
<span class="font-semibold text-pink-500 inline-block my-1">FROM</span>
  table_name
<span class="font-semibold text-pink-500 inline-block my-1">WHERE</span>
  table_cell_id = <span class="font-semibold text-blue-400 inline-block">1</span>;</code>
</pre>

  <div class="float-right relative"><i class="bg-white p-2 text-sm w-28 absolute tooltip to-top" style="--arrow-size:5px;"><a class="whitespace-pre underline font-semibold" href="https://assembly.ai" target="_blank">Assembly AI ↗</a>
Generate SQL from audio recordings</i><div class="mr-2 right-full absolute mt-4 inline-block border-current text-red-600 rounded-full p-3 border-2 tooltip no-hover no-focus no-focus-within slide" id="recording"><div class="absolute inset-0.5 rounded-inherit bg-current"></div></div>

<button class="bg-blue-200 ripple relative mr-4 float-right border-dashed border-gray-500 border p-3 rounded-2xl" onclick="Abbr.to(configure, ['nES', 'cL']).add('show')"><i><img src="/static/assemblyai.svg" class="w-12"></i></button></div>
<button id="sendQuery" class="z-1 align-middle relative text-sm ml-4 my-2" onclick="let txt=Abbr.to(this, {2:'lC'}), query=page.asText(queries).trim(); query+=';'.repeat(!/;$/.test(query)), query&&(page.templates[page.i] = queries.innerHTML, this.disabled=txt.data='awaiting query results....', Abbr.to(this, ['nES','cL']).replace('absolute', 'show'), bugs.classList.remove('show'), result.classList.remove('show'), ['embedding', 'metadata'].forEach(p=>account[p].value=page[p]), account.query.value=query, submit())" disabled="">
    <div class="mt-0.5 -ml-px absolute h-1/2 w-1/5 rounded-tl-full border-t border-l border-current top-0 left-0"></div>
    <div class="mt-2 rounded-3xl overflow-hidden absolute inset-0 text-green-400 m-1 mb-2"><div style="transform-origin: bottom; animation-duration: 3s; transform-origin: top right" class="w-1/3 top-1/2 origin-center bg-gradient-to-r from-transparent via-current to-tansparent absolute animate-spin p-10"></div></div>
<div class="absolute h-1/2 w-1/4 rounded-br-full bottom-0 right-0 border-b border-r border-current mb-0.5 -mr-0.5"></div>
<div class="hover:bg-green-100 mt-3 m-2 mx-1 relative inline-block  p-2 px-3 rounded-3xl bg-gray-100 ripple backdrop-filter backdrop-blur ripple text-current">
  <i class="fa fa-cog inline-block align-middle pointer-events-none"></i>
  <i class="fa fa-database inline-block align-middle mr-2 pointer-events-none"></i>apply query to database</div></button>
  <div style="z-index: auto;" class="left-0 m-5 absolute w-36 inline-block no-hover no-focus slide tooltip">
    <svg class="mr-1 inline-block w-8 align-middle text-red-600" viewBox="0 0 384 512">
      <path pathLength="1" style="fill:orange;" class="draw-stroke" stroke-width="30" stroke="currentColor" d="M216 23.86c0-23.8-30.65-32.77-44.15-13.04C48 191.85 224 200 224 288c0 35.63-29.11 64.46-64.85 63.99-35.17-.45-63.15-29.77-63.15-64.94v-85.51c0-21.7-26.47-32.23-41.43-16.5C27.8 213.16 0 261.33 0 320c0 105.87 86.13 192 192 192s192-86.13 192-192c0-170.29-168-193-168-296.14z"></path>
    </svg>
    <i>keepin it hot...</i>
  </div>
  <button id="result" style="z-index:auto" onclick="Abbr.to(this, ['nES', 'cL']).add('show')" class="ripple tooltip no-hover no-focus no-focus-within slide-y absolute top-0 right-0 m-1 border border-gray-300 bg-gray-100 shadow p-3 rounded-bl-2xl px-4 hover:bg-gray-200 rounded-tr-2xl">show query result</button>
  <!-- result of database will be displayed via this element by clicking on the button above-->
<aside class="no-focus-within p-8 left-0 bg-gray-100 h-full w-full tooltip no-hover no-focus slide-y absolute top-0">
  <h4 class="font-semibold mb-4">Non-empty result of query</h4>
  <div class="sm:absolute top-6 right-10">
    <button class="p-3 rounded-l-full border border-gray-700 ripple relative" onclick="copyTextToClipboard(Abbr.to(this, ['pN', 'nES',   'tC']))">
      <div class="bg-gray-50 text-current p-2 absolute tooltip no-hover to-top" style="--arrow-size:5px;--x: -50%;--y: -3px;">copied</div>
      <i class="fa-copy fa mr-2"></i> copy result</button>
    <button onclick="Abbr.to(this, [{2:'pN'}, 'cL']).remove('show')" class="relative p-3 rounded-r-full border border-gray-700 ripple">
      <i class="fa-times fa mr-2"></i> close</button>
  </div>
  <pre tabindex="0" class="w-full h-full overflow-scroll word-break whitespace-pre-wrap pb-8"></pre>

</aside>
    </main>
    </section>

    <aside id="bugs" class="fixed bottom-20 tooltip no-focus no-hover no-focus-within slide left-3">
      <article style="z-index: auto;" class="bg-white text-sm p-3 absolute bottom-0 left-0 border border-gray-300 rounded-3xl -m-1.5 pt-8 tooltip no-hover no-focus slide-y">
        <h3 class="font-semibold text-gray-600 whitespace-pre mx-3">Starter kit is bedevilled by <code><n> errors</n></code></h3>
<hr class="my-1 w-1/2 m-auto">
<ul class="px-2 overflow-scroll mb-16 pb-4 list-disc list-inside space-y-4" style="max-height:50vh;"></ul>
      </article>
      <div class="text-left relative inline-block rounded-full align-middle text-red-500">
        <div class="rounded-inherit overflow-hidden absolute inset-1"><div style="transform-origin: bottom; animation-duration: 3s;" class="left-1/3 bg-gradient-to-r from-transparent via-current to-tansparent h-full bottom-1/4 w-1/2 absolute animate-spin"></div></div>
        <button class="ripple m-2 inline-block p-5 bg-white rounded-inherit text-current fa md:text-2xl text-xl relative hover:bg-black fa-bug text-current duration-300 ease-out" onclick="Abbr.to(this, ['pN','pES','cL']).toggle('show')"></button>
        <aside class="bg-gray-50 font-mono border text-sm whitespace-pre absolute show p-2 tooltip to-right" style="--arrow-size:5px;">error(s)</aside>
      </div>
    </aside>

    <aside class="z-3 flex items-end justify-between fixed right-0 left-0 bottom-0 p-5 sm:justify-around text-center text-sm">
      <div class="relative">
        <button class="bg-gray-100 shadow-inner z-1 relative p-3 text-sm rounded-lg rounded-l-2xl border"><i class="fa fa-code text-gray-500 text-xl sm:text-base"></i><span class="ml-2 tooltip no-hover no-focus no-focus-within slide sm:show sm:relative absolute">attributions</span></button>
        <div style="z-index: auto;" class="pb-12 text-sm p-4 bg-gray-200 left-0 bottom-1 shadow tooltip absolute rounded-lg w-40">
          <a target="_blank" href="https://css-tricks.com/single-element-loaders-the-dots/"><i class="inline-block p-2 dots-1 text-gray-600"></i> • Temani Afif</a>
          <hr class="my-2">
          <a target="_blank" href="https://uiverse.io/profile/Voxybuns"><label class="switch" style="--slider-checked-color:gray;--switch-size:12px;"><span class="slider"></span></label> • Voxybuns</a>
        </div>
      </div>

      <button class="relative rounded-xl p-4 bg-gray-200 ripple shadow-inner" onclick="setTimeout(_=>configure.querySelector('input').focus(), 400), configure.classList.add('show')"><i class="fa fa-cog"></i> configure</button>
      
      <section class="relative relative">

<button class="rounded-lg border rounded-r-xl ripple relative bg-gray-100 p-3 shadow-inner"><i class="text-gray-700 inline-block align-middle text-2xl sm:text-2xl mr-1.5 fa fa-save"></i><span class="ml-2 tooltip no-hover no-focus no-focus-within slide sm:show sm:relative absolute">save <code class="text-yellow-700 ml-2 text-xs font-semibold">{query, result}</code></span></button>
<ul class="border-gray-300 border rounded-lg bg-gray-50 w-40 -ml-10 sm:m-0 sm:w-full text-left bottom-16 absolute tooltip [&>*]:rounded-inherit to-top" style="--arrow-size:5px;--delay: 0.2s;">
 
  <li class="hover:border-current border"><button onclick="let SQL=page.asText(queries), download = `let query_result = {\n\tquery: \`${SQL+=';'.repeat(!/;$/.test(SQL))}\`${page.result?',\n\tresult:'+page.result:''}\n}`; save(new Blob([download], { type: 'application/javascript' }), 'query-result.js', page.result)" class="ripple relative w-full text-left text-sm"><i class="align-middle text-gray-500 border-r border-current inline-block fa fa-download mr-3 p-3 pr-2.5 text-2xl"></i>Download</button></li>
  <li class="hover:border-current border">
<!--pinata-->
<button class="ripple relative ripple w-full text-left"><!--the button causes a focusin which retains the tooltip's visibility-->
<img src="/static/pinata.svg" class="mr-3.5 pointer-events-none inline-block w-12 border-r border-gray-500 p-2"><span class="text-sm inline-block">Pinata</span>
        </button>
        <form id="pinata" onsubmit="let payload, split='<_8c23#_>', sql=page.asText(queries).replace(/\n+/g, ' ').trim(), data = ['name', 'gateway', 'jwt', 'cid'].map(name=>this[name].value).join(split), sm=this.smash, load = Abbr.to(sm, ['pES', 'cL']); sm.textContent='...smashing the pinata!', sm.disabled=!0, load.add('show');
        if(sql) page.result||='',  payload = `{\nquery: \`${sql+=';'.repeat(!/;$/.test(sql))}\`${page.result?',\n\tresult:'+page.result:''}\n}`+split+data,
        fetch('https://voice-sql-ai.vercel.app/api/pinata', {
          method: 'POST', headers: { 'Content-Type': 'text/plain' },
          body: `data=${payload}&local=${page.isLocal}`
        }).then(res=>res.json()).then((json, out)=>{
          load.remove('show'), sm.textContent = 'smash the pinata!', sm.disabled=0,
          Abbr.to(out = this.querySelector('aside'), 'cL').add('show'), Abbr.to(out, 'lEC').innerText = both.format(JSON.stringify(json))
        }).catch(console.warn);
        return false;" class="text-xs sm:text-sm text-left bg-white border-2 sm:bottom-0 absolute tooltip px-4 sm:py-4 py-2 sm:right-full bottom-full right-0" style="--delay:0.5s"><i class="mr-1 fa fa-file"></i> File mode:
          <div class="ml-3 my-2 inline-flex text-gray-700" onclick="let e=event.target, _i; slice(this.children).forEach((ch, i)=>ch.classList[ch==e?(_i=i, 'add'):'remove']('border-current')), slice(Abbr.to(this, ['nES', 'children'])).map((n, i)=>(n.classList[i==_i?'add':'remove']('show'), slice(n.querySelectorAll('input')))).forEach((arr, i)=>arr.forEach(el=>{ el[(i==_i?'set':'remove')+'Attribute']('required', '') }))">
            <button type="button" class="ripple relative p-2 rounded-br-lg text-current px-4 border-b-2 border-r-2 border-current">upload</button>
<button type="button" class="relative p-2 border-l-2 rounded-tl-lg text-current px-4 ripple border-t-2">retrieve</button></div>
    <section class="relative"><fieldset class="show">
      <i class="fa-file-export fa"></i> Payload
      <pre class="text-xs mt-1 mb-2 p-1.5 block bg-blue-100 rounded-lg px-4">{ query: SQL <i class="fa fa-plus"></i> result: query result }</pre>
      <label class="border-current px-3 inline-block border-l border-t rounded-tl-lg">Filename: <input name="name" class="border-l border-current p-2.5 outline-none" size="18" value="doesn't-matter.txt" required=""></label>
      <br><label>Gateway URL:
  <input name="gateway" class="p-2.5 outline-none border-b border-current rounded-bl-lg border-l" size="30" required=""></label><label class="mt-3 block mb-1">Pinata JWT:
  <input name="jwt" class="p-2.5 outline-none border-b border-current rounded-br-xl border-r" size="30" required="">
  </label></fieldset>
  <fieldset style="z-index:auto" class="tooltip -slide-y no-hover flex items-center bg-white no-focus absolute inset-0"><label>CID provided for an upload prior
<input name="cid" class="p-2.5 outline-none border-b border-current rounded-bl-lg border-l" size="30">
</label></fieldset></section>
<!-- element for showing responses from Pinata, brought here to have a higher z-index that the fieldsets above -->
<aside style="z-index:auto" class="tooltip no-hover top-16 bottom-24 no-focus no-focus-within absolute inset-0 bg-gray-50">
  <button type="button" onclick="Abbr.to(this, ['pN','cL']).remove('show')" class="right-0 ripple px-4 p-3 fa fa-times text-lg absolute border border-gray-600"></button>
  <pre class="text-xs w-full h-full overflow-scroll pt-4 pb-8 word-break p-2 whitespace-pre-wrap pt-4">{<br>	"statusCode":500,"details":"{<br>	\"status\":500,\"error\":\"cid not found\"<br>}",<br>	"name":"NetworkError"<br>}</pre>
</aside>
      <div class="relative float-right p-1.5">
        <span class="-left-6 top-1/2 no-hover no-focus tooltip slide absolute transform rotate-45"><hr class="border-white -mb-0.5 bottom-1/2 left-1/2 anim-round absolute border-4 border-yellow-600 rounded-full" style="animation:anim-round .8s ease-out infinite; --_reach: calc(-1*var(--reach)); --reach: 1.2rem;"></span>
        <button name="smash" class="mt-1.5 p-3 px-4 bg-center shadow ripple relative rounded-lg font-semibold" style="background-image: url(/static/theme.avif);">smash the pinata!</button>
      </div>
<i class="mt-0.5 w-full text-center inline-block text-xs sm:text-sm">Data upload/retrieval on the IPFS by <span class="font-fredoka">Pinata</span>, <a href="https://app.pinata.cloud/developers/keys" class="bg-yellow-400 p-1.5 inline-block" target="_blank">open an account</a> and/or fill the fields above to use it</i>
</form>
 </li>

</ul>
      </section>

    </aside>
    
    <!-- iframe for receiving responses for the form with id=account for communicating with the server -->
    <iframe frameborder="0" class="invisible pointer-events-none absolute top-0 " id="response" name="response" onload="let res; (res=this.contentWindow.document.body.textContent)&&receive(res)"></iframe>

<script>
let delayed;
function flash(node, delay, color, cb, cls) {
  (cls = node.classList).add(color), setTimeout(_=>{
    cls.remove(color), cb()
  }, delay)
}
function submit() {
  fetch(account.action,{method:account.method, body:new FormData(account)})
  .then(res=>res.json())
  .then(receive)
  .catch(err=>receive({error:err.message+' '+err.reason}))
} 
function receive(res, len, html='', btn) {
  // res=JSON.parse(res), 
  Abbr.to(sendQuery, {2:'lC'}).data='apply query to database', Abbr.to(sendQuery, ['nES','cL']).replace('show', 'absolute');/* remove "keepin it hot" fire svg */
  /*end of restoring state before sending query*/

  if(!res.configured) return;
  else page.setup(configure.querySelector('main'), account.setup.value||res.configured), configure.querySelector('button').click();
  res.result!=void 0 &&setTimeout(_=>Abbr.to(configure.querySelector('button'), 'fEC').style.setProperty('--dur', '2s'), 1000);

  if(sendQuery.disabled = res.errors&&res.errors.length) {
    configure.classList.remove('show'), 
    Abbr.to(bugs, 'cL').add('show'), res.errors.forEach(error=>{
      html+=`<li><code class='block mb-3.5'>${error[0]}</code>Fix: <i>${error[1]}</i></li>`
    }), flash(queries, 300, 'bg-red-300', _=>{
      bugs.querySelector('code').textContent = (len=res.errors.length) +' error'+ 's'.repeat(len!=1), bugs.querySelector('ul').innerHTML=html
    });
    return
  }

  if(res.result) {
    account.query.value = '',
    /*green flash effect on query input area to signal success */
    flash(queries, 800, 'bg-green-100', _=>{
      res.result.length&&(Abbr.to(result, 'nES').querySelector('pre').innerText=page.result=both.format(JSON.stringify(res.result).replace(/\\"/g, '')
      .replace(/"\{/g, '{').replace(/\}"/g, '}')
    ))
    });
    res.result.length&&result.classList.add('show');
    return
  }
  /*prefill input elements for the data if they are available and sent by the client*/
  ['jwt', 'gateway'].forEach(key=>res[key]&&(pinata[key].value = res[key])),
  setTimeout(_=>['database', 'version'].forEach((field, i, a, _i)=>(a=res[field]||=page.misc[field], a)&&((_i=delayed[i]).textContent  = res[field], _i.classList.remove('skeleton'))), 1e3),
  /*only expected to be executed for very first response*/
  loader1.classList.remove('dots-1'),
  /* provide host as server address if it is not sent as IP by the server */
  page.misc.addr = page.misc.host,
  ['addr', 'port'].forEach((str, val, id)=>(val=res[id='server_'+str]||page.misc[str])&&(window[id].textContent = val))
}

debug&&Ev('onbeforeunload')(W)(_=>"Prevents unintentional reloads of the page when in debug i.e dev mode");
let DOMLoaded, vars=[], crE = (tag, attrs, values)=>(tag = document.createElement(tag), values&&Object.keys(values).forEach(key=>tag[key]=values[key]), attrs.forEach(attr=>tag.setAttribute(attr.name, attr.value)), tag);

w_Ev_dom(function(style, types) {
  animations.addRippleAnimations();
  hljs.highlightAll();
  if(debug) return;
  delayed = qsa('.skeleton'), configure.classList.add('show'),
  (style=document.documentElement.style).backdropFilter == void 0&&style.setProperty('--bg-opacity-pad', 0.5),
  DOMLoaded = !0,

  /*initial request to synchronize config variables with UI
  is only done in the local instance of this webapp
  */ 
  (account.local.value = page.isLocal)&&submit(),

  types = crE('datalist', [], {id:'types'}), 
  ['DECIMAL(<N>, <N>)', 'FLOAT', 'BIGINT', 'INT', 'SMALLINT', 'TINYINT', 'FLOAT(<N>)', 'BIT(<N>)', 'JSON', 'YEAR', 'DATE', 'TIME', 'DATETIME', 'TIMESTAMP', 'CHAR(<N>)', 'BINARY(<N>)', 'VARCHAR(<N>)', 'VARBINARY(<N>)', 'TINYBLOB', 'TINYTEXT', 'BLOB', 'TEXT', 'MEDIUMBLOB', 'MEDIUMTEXT', 'LONGBLOB', 'LONGTEXT', 'ENUM(...)', ' SET(...)']
    .forEach((type, el)=>{
      types.appendChild(crE('option', [], {value:type}))
    }), document.body.appendChild(types)
})

function inView(value) { 
  const item = value.getBoundingClientRect(); 
  return ( 
      item.top >= 0 && 
      item.left >= 0 && 
      item.bottom <= ( 
          window.innerHeight || 
          document.documentElement.clientHeight) && 
      item.right <= ( 
          window.innerWidth || 
          document.documentElement.clientWidth) 
  );
}
/* reset cached offsetTop value for every window resize */
w_Ev_rz(_=>vars[0]=0)

w_Ev_scroll(function(y) {
  y = this.scrollY,
  pooled.classList[cLs(y>(/*vars[0]||=*/pooled.offsetTop))]('affix')
})

</script>
</body></html>